-------------------------------------------------------------
-- muestra las fechas son el 0 inicial ose "01" lo muestra como "1"

--TO_CAHR PASA DE NUMEROS A TEXTO
SELECT TO_CHAR(HIRE_DATE,'fnDD Month YYYY') from OEHR_EMPLOYEES;


-- asi se muestra la fecha normal "01"
SELECT TO_CHAR(HIRE_DATE,'DD Month YYYY') from OEHR_EMPLOYEES;



SELECT LENGTH(TO_CHAR(HIRE_DATE,'fmDD Month YYYY')) from OEHR_EMPLOYEES as largofm;

SELECT LENGTH(TO_CHAR(HIRE_DATE,'DD Month YYYY')) from OEHR_EMPLOYEES as largonormal;

----------------
--hacer este

SELECT TO_CHAR(HIRE_DATE,'fnDD Month YYYY') as CONFM,
TO_CHAR(HIRE_DATE,'DD Month YYYY') as SINFM, 
LENGTH(TO_CHAR(HIRE_DATE,'DD Month YYYY')), 
LENGTH(TO_CHAR(HIRE_DATE,'fmDD Month YYYY')) 
FROM OEHR_EMPLOYEES;


-----------mostar fecha acutaul en cieto fromato
SELECT TO_CHAR(SYSDATE,'DAY DDth MONTH "OF" YYYY')
FROM Dual;

------------visualmete hacerlo en espaÃ±ol
SELECT TO_CHAR(SYSDATE,'DAY DD MONTH "de" YYYY', 'NLS_DATE_LANGUAGE=SPANISH')
FROM Dual;

-- PARA MOSTAR EL SALRIO DE UN CIERTO FROMARTO, LA CATIDAD DE 99 ES LA QUES EMOSTRARA
SELECT TO_CHAR(SALARY, '$99,999.99') AS SALARIO
FROM OEHR_EMPLOYEES;


---
SELECT EMPLOYEE_ID AS COD_EMPELADO, FIRST_NAME||' '|| LAST_NAME AS NOMBRE_COMPLETO,
EMAIL||'@DB.UCM.CL' AS EMAIL, TO_CHAR(SALARY, '$99,999.99') AS SALARIO
FROM OEHR_EMPLOYEES
ORDER BY SALARY DESC;


-- FROZAR QUE UN TEXTO PASE A NUMERO ES TO_NUMBER

SELECT TO_CHAR(SYSDATE,'YYYY') AS TEXTO
FROM Dual;


--- LA VERSION DE TEXTO Y LA VERISON A NUMERO DE LA FECHA
SELECT TO_NUMBER(TO_CHAR(SYSDATE,'YYYY'),'9999') AS NUMERO, TO_CHAR(SYSDATE,'YYYY') AS TEXTO
FROM Dual;


-- DUMP PARA HACERLA UNA AUDITORIA A ESA DATA, ASI SABMOS QUE TIPO DE DATO ES Y TODO ESO
SELECT DUMP(TO_NUMBER(TO_CHAR(SYSDATE,'YYYY'),'9999')) AS NUMERO, DUMP(TO_CHAR(SYSDATE,'YYYY')) AS TEXTO
FROM Dual;


---
SELECT TO_DATE('02-02-25', 'DD-MM-YY') FROM Dual;
----fx nos exige que tengamos el formato

SELECT TO_DATE('02-02-25', 'fxDD-MM-YY') FROM Dual;

----------
SELECT TO_DATE('01-01-49', 'DD-MM-YY') FROM Dual;









--clase MIERCOLES 10/09/25
------------------


--- APORXIMAR CON ROUND
SELECT ROUND(AVG(SALARY), 0) AS "PROMEDIO SUELDO"
FROM OEHR_EMPLOYEES;

---------PROMDEIO DE SALARIOS DEL DEPARAMENTE 90
SELECT ROUND(AVG(SALARY), 0) AS "PROMEDIO SUELDO DEL DEPARTAMENTO 90"
FROM OEHR_EMPLOYEES
WHERE DEPARTMENT_ID = 90;


--- QUISIRA SABER PRIMERA Y ULTIMA FECHA DE CONTRATACION DE EMPLEADOS

SELECT MIN(HIRE_DATE) AS "PRIMERA FECHA", MAX(HIRE_DATE) AS "ULTIMA FECHA"
FROM OEHR_EMPLOYEES;

--- SABER CANTIDAD DE DEPARTAMNETO QUE PERTENDCE POR LO MENOS A UN TRBAJO
SELECT COUNT(DISTINCT(DEPARTMENT_ID))
FROM OEHR_EMPLOYEES;

---- QUISIERA SABER TRBAJADORES QUE GANAN MAS DE 10MIL DOLARES

SELECT COUNT(EMPLOYEE_ID) 
FROM OEHR_EMPLOYEES
WHERE SALARY > 10000;


-- QUISIRE SABER LA DIFERENCIA DE LOS SUELDOS MAXIMO Y MINIMO

SELECT MAX(SALARY)- MIN(SALARY) AS "DIFERENCIA DE SUELDOS"
FROM OEHR_EMPLOYEES;

---REPORTE CON PROMEDIO

-----ESTO NO FUCNIONA
SELECT DEPARTMENT_ID, AVG(SALARY) AS "PROMEDIO DE SUELDOS"
FROM OEHR_EMPLOYEES;


--- SE RESUELVE DELA SIGUIENTE MANERA, USANDO GROUP BY
SELECT DEPARTMENT_ID AS "COD_DEPARTAMNETO", ROUND(AVG(SALARY),0) AS "PROM_SUELDOS"
FROM OEHR_EMPLOYEES
GROUP BY DEPARTMENT_ID;

--- SI LO QUISIERAMOS ORDENAR POR DEPARTAMENTEO

SELECT DEPARTMENT_ID AS "COD_DEPARTAMNETO", ROUND(AVG(SALARY),0) AS "PROM_SUELDOS"
FROM OEHR_EMPLOYEES
GROUP BY DEPARTMENT_ID
ORDER BY 1;


------------AGRUPAR CUADO LA DALID SEA DIFERENTE POR EJEMPLO SUM SOLO SALDRA 1, Y DEPART Y JOB ID LA SALIDA SERA DE MAS DE 100
---

---REPASAR
SELECT DEPARTMENT_ID AS "COD_DEPARTAMENTO", JOB_ID AS "CARGO", TO_CHAR(SUM(SALARY), '$999,999.99') AS "SUMA_SUELDOS"
FROM OEHR_EMPLOYEES
GROUP BY DEPARTMENT_ID, JOB_ID
ORDER BY DEPARTMENT_ID;

---------------------------------------
--ESTO ESTAMAL HACE FALTA OTRA CALUSULA
SELECT MAX(SALARY) AS "SUELDO_MAXIMO" , DEPARTMENT_ID
FROM OEHR_EMPLOYEES
WHERE MAX(SALARY) > 10000
GROUP BY DEPARTMENT_ID

-------
--- SE USA HAVING
SELECT MAX(SALARY) AS "SUELDO_MAXIMO" , DEPARTMENT_ID
FROM OEHR_EMPLOYEES
GROUP BY DEPARTMENT_ID
HAVING MAX(SALARY) > 10000;


--------------------------
SELECT DEPARTMENT_ID AS "COD_DEPARTAMENTO", MAX(SALARY) AS "SUELDO_MAXIMO"
FROM OEHR_EMPLOYEES
WHERE DEPARTMENT_ID BETWEEN 50 AND 90
GROUP BY DEPARTMENT_ID
HAVING MAX(SALARY) > 10000
ORDER BY DEPARTMENT_ID DESC;



